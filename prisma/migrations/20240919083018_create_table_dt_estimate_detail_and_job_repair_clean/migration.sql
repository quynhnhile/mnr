-- CreateTable
CREATE TABLE "dt_estimate_detail" (
    "id" BIGSERIAL NOT NULL,
    "id_estimate" BIGINT NOT NULL,
    "estimate_no" VARCHAR(50) NOT NULL,
    "comp_code" VARCHAR(50) NOT NULL,
    "loc_code" VARCHAR(50) NOT NULL,
    "dam_code" VARCHAR(50) NOT NULL,
    "rep_code" VARCHAR(50) NOT NULL,
    "length" DECIMAL(18,2) NOT NULL,
    "width" DECIMAL(18,2) NOT NULL,
    "quantity" INTEGER NOT NULL,
    "unit" VARCHAR(5) NOT NULL,
    "hours" DECIMAL(18,2) NOT NULL,
    "cwo" VARCHAR(50) NOT NULL,
    "labor_rate" DECIMAL(18,2) NOT NULL,
    "labor_price" DECIMAL(18,2) NOT NULL,
    "mate_price" DECIMAL(18,2) NOT NULL,
    "total" DECIMAL(18,2) NOT NULL,
    "currency" VARCHAR(5) NOT NULL,
    "payer" VARCHAR(50) NOT NULL,
    "rate" DECIMAL(20,2) NOT NULL,
    "is_clean" BOOLEAN NOT NULL DEFAULT false,
    "clean_method_code" VARCHAR(50),
    "clean_mode_code" VARCHAR(50),
    "status_code" VARCHAR(50) NOT NULL,
    "local_approval_date" TIMESTAMPTZ(3),
    "local_approval_by" VARCHAR(36),
    "approval_date" TIMESTAMPTZ(3),
    "approval_by" VARCHAR(36),
    "req_active_date" TIMESTAMPTZ(3),
    "req_active_by" VARCHAR(36),
    "cancel_date" TIMESTAMPTZ(3),
    "cancel_by" VARCHAR(36),
    "is_opr_cancel" BOOLEAN NOT NULL DEFAULT false,
    "note" TEXT,
    "created_date" TIMESTAMPTZ(3) DEFAULT CURRENT_TIMESTAMP,
    "created_by" VARCHAR(36) NOT NULL,
    "modified_date" TIMESTAMPTZ(3),
    "modified_by" VARCHAR(36),

    CONSTRAINT "dt_estimate_detail_pkey" PRIMARY KEY ("id")
);

-- CreateTable
CREATE TABLE "job_repair_clean" (
    "id" BIGSERIAL NOT NULL,
    "id_ref" BIGINT NOT NULL,
    "id_cont" VARCHAR(50) NOT NULL,
    "container_no" VARCHAR(20) NOT NULL,
    "id_est_item" BIGINT NOT NULL,
    "estimate_no" VARCHAR(50) NOT NULL,
    "id_job" VARCHAR(50) NOT NULL,
    "seq" INTEGER NOT NULL,
    "rep_code" VARCHAR(50) NOT NULL,
    "is_clean" BOOLEAN NOT NULL DEFAULT false,
    "clean_method_code" VARCHAR(50),
    "clean_mode_code" VARCHAR(50),
    "job_status" VARCHAR(20) NOT NULL,
    "start_date" TIMESTAMPTZ(3),
    "start_by" VARCHAR(36),
    "finish_date" TIMESTAMPTZ(3),
    "finish_by" VARCHAR(36),
    "cancel_date" TIMESTAMPTZ(3),
    "cancel_by" VARCHAR(36),
    "complete_date" TIMESTAMPTZ(3),
    "complete_by" VARCHAR(36),
    "vendor_code" VARCHAR(50) NOT NULL,
    "is_reclean" BOOLEAN NOT NULL DEFAULT false,
    "id_ref_reclean" BIGINT,
    "reclean_reason" TEXT,
    "kcs_status" INTEGER NOT NULL DEFAULT 0,
    "kcs_note" TEXT,
    "note" TEXT,
    "created_date" TIMESTAMPTZ(3) DEFAULT CURRENT_TIMESTAMP,
    "created_by" VARCHAR(36) NOT NULL,
    "modified_date" TIMESTAMPTZ(3),
    "modified_by" VARCHAR(36),

    CONSTRAINT "job_repair_clean_pkey" PRIMARY KEY ("id")
);

-- AddForeignKey
ALTER TABLE "dt_estimate_detail" ADD CONSTRAINT "dt_estimate_detail_id_estimate_fkey" FOREIGN KEY ("id_estimate") REFERENCES "dt_estimate"("id") ON DELETE RESTRICT ON UPDATE CASCADE;
